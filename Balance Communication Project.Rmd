---
title: "Balance Communication Project"
author: "Levi_Bagwell"
date: "April 16, 2020"
output: html_document

Goals: Create a code using python that will communicate with a balance, take readings at certain time intervals, and also put those readings into a .csv file.

Part 1: Levi - Establish communication with balance. 

#!/usr/bin/env python3
import time
import serial

ser = serial.Serial(
 port='/dev/ttyUSB0',
 baudrate = 2400,
 parity=serial.PARITY_EVEN,
 stopbits=serial.STOPBITS_ONE,
 bytesize=serial.SEVENBITS,
 timeout=None
)

while 1:
 x=ser.readline()
 print(x)
 
Resources Consulted: 
- Balance Communication (instructables.com)
- Software Interfaces Sartorius Balances to PC(windmill.co.uk)
- Balance Communication Software WinCT (Balances.com)
Notes: At this point in our project I am trying to do some research on how people have been able to interface with various brands of balances. This information will hopefully give me insight on what to look for and where to start when beginning the process of interfacing with the balance that we have on hand. 

Part 2: Gus - Design code to take readings at certain time intervals
#For the function i am contributing to, i am looking into possible software that will allow the scale to take readings at certain time intervals. I have been specifically looking into RsWeight programs to help with the issue. In the program, one can set many perameters and take readings at specific intervals. There is options in this program to export to an Excell file and have the data arranged respectively. Need to see what components are required for the specific program and if its a possibility.
I believe the code below will take readings every 10 seconds by continuously exucuting Levis code.
I need to figure out a stop code so it will not take measurments continuously


import time

def readmass():
    LEVIS CODE IS INSERTED HERE I BELIEVE
    time.sleep(10)

while True:
    readmass()
    
Resources Consulted:
- Software info (https://www.aandd.jp/products/software/winct.html)
- Python guide https://docs.python.org/3.4/library/time.html

Part 3: Emily - Design code to insert readings into certain parts of a .csv file.
After the readings are collected at specific time intervals and recorded, they will need to be placed in an orderly fasion in a program. 
Excel will not be used, but rather a csv file. A csv file is is a delimited text file that uses a comma to separate values. 
A CSV file is different than a XLS file because a CSV format is a plain text format in which values are seperated by commas. An XLS file format is an Excel sheets binary file format that hold information about all the worksheets in a file, both content and formatting. 
Code will be created in order to place the recordings in certain cells in the .csv file. The recordings will be labeled accordingly using a code. 
This is the last step in the project, so research is continuing on the best way to format the data in the .csv file, while we establish communication with the scale. 
This is just a start there may need to be more added.

Import CSV
Result = ()
with open('output.csv', 'w') as csvfile:
    csvwriter = csv.writer(csvfile)
    for row in result.items():
        csvwriter.writerow(row)
        
Resources Consulted:
CSV file management: https://www.geeksforgeeks.org/csv-file-management-using-c/
What is a CSV File and How to open the CSV File Format: https://www.freecodecamp.org/news/what-is-a-csv-file-and-how-to-open-the-csv-file-format/
